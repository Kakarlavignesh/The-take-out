<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Staff Portal - The Takeout</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav class="navbar">
        <div class="logo">
            <!-- Image removed as per user request -->
            The Takeout
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Main Site</a></li>
        </ul>
    </nav>

    <section>
        <div id="login-section">
            <input type="text" id="staff-id-input" placeholder="Your ID" style="padding:10px;">
            <button onclick="loginStaff()">View My Details</button>
        </div>

        <div id="details-section"
            style="display:none; margin-top:2rem; background:rgba(255,255,255,0.05); padding:2rem; border-radius:10px;">
            <h2 id="staff-name"></h2>
            <p><strong>Role:</strong> <span id="staff-role"></span></p>
            <p><strong>Department:</strong> <span id="staff-dept"></span></p>
            <hr style="border-color:var(--glass-border); margin:1rem 0;">
            <p><strong>Current Salary:</strong> $<span id="staff-salary"></span></p>
            <p><strong>Yearly Performance:</strong> <span id="staff-perf"></span>/10</p>
            <p><strong>Attendance:</strong> <span id="staff-attendance"></span> Days Present</p>

            <div style="margin-top:2rem; padding:1rem; background:rgba(0,0,0,0.3);">
                <h4>Attendance Check</h4>
                <button onclick="markPresent()">Mark Present Today</button>
            </div>
        </div>
    </section>

    <script>
        async function loginStaff() {
            const id = document.getElementById('staff-id-input').value;
            const res = await fetch(`/api/employees/${id}`);
            if (res.ok) {
                const emp = await res.json();
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('details-section').style.display = 'block';

                document.getElementById('staff-name').innerText = emp.name;
                document.getElementById('staff-role').innerText = emp.role;
                document.getElementById('staff-dept').innerText = emp.department;
                document.getElementById('staff-salary').innerText = emp.salary;
                document.getElementById('staff-perf').innerText = emp.performanceRating;
                document.getElementById('staff-attendance').innerText = emp.daysPresent || 0;
            } else {
                alert("Employee Not Found");
            }
        }

        async function markPresent() {
            const id = document.getElementById('staff-id-input').value;
            if (!id) return alert("Please Login First");

            const res = await fetch(`/api/attendance/${id}`, { method: 'POST' });
            if (res.ok) {
                const data = await res.json();
                alert(data.message);
                loginStaff(); // Refresh details
            } else {
                alert("Failed to mark attendance");
            }
        }
    </script>

</body>

</html>