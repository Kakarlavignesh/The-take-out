<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>My Profile - The Takeout</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .wallet-card {
            background: linear-gradient(135deg, var(--accent-color), #daa520);
            padding: 2rem;
            border-radius: 20px;
            color: black;
            text-align: center;
            max-width: 400px;
            margin: auto;
            position: relative;
            overflow: hidden;
        }

        .wallet-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(45deg);
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <div class="logo">
            <!-- Image removed as per user request -->
            The Takeout
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="menu.html">Menu</a></li>
            <li><a href="admin.html">Admin</a></li>
        </ul>
    </nav>

    <section>
        <div class="wallet-card">
            <h2>The Takeout Wallet</h2>
            <div style="font-size: 3rem; font-weight: bold; margin: 1rem 0;">
                <span id="wallet-balance">0</span> ü™ô
            </div>
            <p>Takeout Coins</p>

            <div style="background: white; padding: 1rem; margin-top: 1rem; border-radius: 10px;">
                <div id="qr-code" style="font-family: monospace; word-break: break-all;">
                    QR_CODE_PLACEHOLDER
                </div>
                <small>Scan this at counter to redeem</small>
            </div>
        </div>

        <div style="text-align:center; margin-top:2rem;">
            <button onclick="simulateBill()" class="cta-button">Simulate Bill Payment (Demo)</button>
            <br><br>
            <a href="index.html" class="cta-button" style="background:transparent; border:1px solid white;">‚Üê Back to
                Home</a>
        </div>

        <!-- Scratch Card Modal -->
        <div id="scratch-modal" class="modal">
            <div class="modal-content" style="text-align:center;">
                <span class="close"
                    onclick="document.getElementById('scratch-modal').style.display='none'">&times;</span>
                <h3>üéâ Payment Successful!</h3>
                <p>You earned a scratch card!</p>
                <div style="background:gray; width:200px; height:100px; margin:auto; display:flex; align-items:center; justify-content:center; cursor:pointer;"
                    onclick="revealReward(this)">
                    <span style="color:white; font-size:1.5rem;">Click to Scratch</span>
                </div>
            </div>
        </div>
    </section>

    <script src="app.js"></script>
    <script>
        async function simulateBill() {
            // Demo function to simulate paying a bill and getting a reward
            document.getElementById('scratch-modal').style.display = 'flex';
        }

        async function revealReward(el) {
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user) return alert("Please Login First");

            const res = await fetch(`${API_BASE}/wallet/generate-reward`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ userId: user.id })
            });

            if (res.ok) {
                const data = await res.json();
                el.style.background = 'var(--accent-color)';
                el.innerHTML = `<span style="color:black; font-weight:bold;">Won ${data.coins} Coins!</span>`;
                loadWallet(); // Refresh balance
            }
        }
    </script>

</body>

</html>